#include <NewPing.h>

#define BAT_PIN      A0
#define VIBRATE_PIN  13
#define TRIGGER_PIN  12  // Arduino pin tied to trigger pin on the ultrasonic sensor.
#define ECHO_PIN     11  // Arduino pin tied to echo pin on the ultrasonic sensor.
#define MAX_DISTANCE 250 // Maximum distance we want to ping for (in centimeters). Maximum sensor distance is rated at 400-500cm.


boolean vibrated = false;
int check;
NewPing sonar(TRIGGER_PIN, ECHO_PIN, MAX_DISTANCE); // NewPing setup of pins and maximum distance.

void setup() {
  pinMode(VIBRATE_PIN, OUTPUT);
  Serial.begin(9600); //115200
  int check = 0;
}

void loop() {

  delay(50); // Wait 50ms between pings (about 20 pings/sec). 29ms should be the shortest delay between pings.

  Serial.print("gucci ");
  Serial.println(sonar.ping_cm()); // Send ping, get distance in cm and print result (0 = outside set distance range)

  if (sonar.ping_cm() <= 70 && sonar.ping_cm() >= 0)
  {
    digitalWrite(VIBRATE_PIN, HIGH);
  } else {
    digitalWrite(VIBRATE_PIN, LOW);
  }

  if ( check >= 9)
  {
    int sensorValue = analogRead(A0);
    float voltage = (sensorValue * (5.0 / 1024.0) * 10);

    Serial.print("gang ");
    Serial.println(voltage);

    if ( voltage < 7.0)
    {
      if (vibrated == false)
      {
        for (int i = 0; i < 3; i++) {
          digitalWrite(VIBRATE_PIN, HIGH);
          delay(1000);
          digitalWrite(VIBRATE_PIN, LOW);
          delay(250);
          Serial.print("ey b0ss");
        }
        vibrated = true;
      }
      Serial.print("oh shiii");
    }
  }

  check = check + 1;
  Serial.println(check);
  if ( check >= 10)
  {
    check = 0;
  }
}

